#!/bin/bash
rm *.lib
rm -rf event2
rm -rf live555
rm -rf lib*/
rm Makefile

tar -zxvf libevent-2.0.22-stable.tar.gz
cd libevent-2.0.22-stable
./configure && make && sudo make install
cd ../

tar -zxvf live555-latest.tar.gz
cd live
./genMakefiles linux
make -j && sudo make install
cd ../

for arg in "$@"
do
	if ["$arg" = "--enable-pipeline"]; then
		tar -jxvf last_x264.tar.bz2
		cd x264-snapshot-20161110-2245
		./configure --enable-shared --enable-static --disable-yasm
		make && sudo make install
		cd ../

		tar -jxvf ffmpeg-3.2.tar.bz2
		cd ffmpeg-3.2
		./configure --enable-gpl --enable-libx264 --enable-shared --disable-yasm
		make && sudo make install
		cd ../
		cat Makefile.head > Makefile
	fi
done
cat Makefile.tail >> Makefile
echo "All ok,Type make to build"
